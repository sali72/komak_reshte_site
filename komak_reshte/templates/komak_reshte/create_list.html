{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Create Field of Study List</title>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
        <script>
            var getFieldsOfStudyUrl = "{% url 'komak_reshte:get_fields_of_study' %}";
            var updateOrderUrl = "{% url 'komak_reshte:update_order' %}";
            var clearListUrl = "{% url 'komak_reshte:clear_list' %}";
            var csrfToken = "{{ csrf_token }}";
        </script>
        
        <script src="{% static 'komak_reshte/scripts.js' %}"></script>
<body>
    <h1>Create Your List of Fields of Study</h1>
    <form method="post">
        {% csrf_token %}
        <div>
            <label for="province">Province:</label>
            {{ form.province }}
        </div>
        <div>
            <label for="field_of_study">Field of Study:</label>
            {{ form.field_of_study }}
        </div>
        <button type="submit">Add to List</button>
    </form>
    <h2>Your List</h2>
    <table id="sortable-table">
        <thead>
            <tr>
                <th>Order</th>
                <th>Unique Code</th>
                <th>Field of Study</th>
                <th>Exam Group</th>
                <th>University</th>
                <th>Requires Exam</th>
                <th>Tuition Type</th>
                <th>First Half Acceptances</th>
                <th>Second Half Acceptances</th>
                <th>Women</th>
                <th>Men</th>
                <th>Extra Information</th>
            </tr>
        </thead>
        <tbody>
            {% if field_list %}
            {% for item in field_list %}
            <tr data-id="{{ item.field_of_study }}">
                <td>{{ item.order }}</td>
                <td>{{ item.unique_code }}</td>
                <td>{{ item.name }}</td>
                <td>{{ item.exam_group }}</td>
                <td>{{ item.university }}</td>
                <td>{{ item.requires_exam }}</td>
                <td>{{ item.tuition_type }}</td>
                <td>{{ item.first_half_acceptances }}</td>
                <td>{{ item.second_half_acceptances }}</td>
                <td>{{ item.women }}</td>
                <td>{{ item.men }}</td>
                <td>{{ item.extra_information }}</td>
            </tr>
            {% endfor %}
            {% else %}
            <tr>
                <td colspan="12">No items in the list yet.</td>
            </tr>
            {% endif %}
        </tbody>
    </table>
    <button id="clear-list-btn">Clear List</button>
    <form method="post" action="{% url 'komak_reshte:export_csv' %}">
        {% csrf_token %}
        <button type="submit">Export to CSV</button>
    </form>
</body>
</html>
